/**
 * Debug the actual content structure generated by Azure OpenAI
 */
require('dotenv').config();

async function debugAzureContentStructure() {
  try {
    console.log('üîç Debugging Azure OpenAI Content Structure...');

    // Import LLM Service
    const llmService = require('./src/services/llmService');

    // Generate a single section to see the structure
    console.log('üìã Generating detailedExplanation section...');
    const result = await llmService.generateDentalServiceContent(
      'Root Canal Treatment',
      'detailedExplanation',
      {
        websiteName: 'Test Clinic',
        keywords: ['root canal', 'endodontic'],
        maxTokens: 800
      }
    );

    console.log('üìä Result Structure:');
    console.log('- Provider:', result.provider);
    console.log('- Model:', result.model);
    console.log('- Tokens Used:', result.tokensUsed);
    console.log('- Content Type:', typeof result.content);
    console.log('- Content Length:', result.content?.length || 'N/A');
    console.log('- Is String:', typeof result.content === 'string');

    console.log('\nüìù First 500 characters of content:');
    console.log(result.content.substring(0, 500));

    console.log('\nüéØ Content Analysis:');
    console.log('- Contains bullet points (‚Ä¢):', result.content.includes('‚Ä¢'));
    console.log('- Contains asterisks (*):', result.content.includes('*'));
    console.log('- Contains numbers (1.):', /\d+\./.test(result.content));
    console.log('- Contains colons (:):', result.content.includes(':'));

    console.log('\nüîç Line-by-line breakdown:');
    const lines = result.content.split('\n');
    lines.slice(0, 10).forEach((line, i) => {
      console.log(`Line ${i+1}: "${line}"`);
    });

  } catch (error) {
    console.error('‚ùå Debug failed:', error.message);
    console.error('Stack:', error.stack);
  }
}

debugAzureContentStructure();